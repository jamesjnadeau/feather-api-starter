var notify = require('notifyUtil');
//A convienance function to handle featherjs xhr errors well
module.exports = function(xhrProblem, callback) {
  if(xhrProblem) {
    var err = JSON.parse(xhrProblem.message);
    console.log('xhrProblem', typeof err, err);
    var message = '';
    message += err.message;
    if(typeof err.error !== 'undefined') {
      if(typeof err.error.errors !== 'undefined') {
        var errors = err.error.errors;
        for(var index in err.error.errors) {
          var value = errors[index];
          message += '<hr><b>'+index+'</b>: '+value.message;
        }
      }
    }
    console.log(message);
    notify('Problem Saving!', message, 'warning');

  }
  if(typeof callback === 'function') {
    callback(err);
  }
};
